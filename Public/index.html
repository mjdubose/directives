<!DOCTYPE html>
<html>

<head>
    <link href='/public/stylesheet.css' rel='stylesheet'>
    <link href='/public/style.css' rel='stylesheet'>
</head>

<body ng-app="D3App" class='body'>
<Video class='background' autoplay loop>
    <source src="/public/videos/malthael.webm" type="video/webm"/>
    <source src="/public/videos/malthael.mp4" type="video/mp4"/>
</video>

<div class='container' ng-controller="SearchBar">

    <div class='search-bar-and-heros-container'>
        <div class='bottom-runner'></div>

        <div class='butcher-container'>
            <div class='butcher-light heart-beat'></div>
            <img class='butcher' src='/Public/images/Butcher.png' />
        </div>

        <div class='leoric-container'>
            <div class='leoric-light heart-beat'></div>
            <img class='leoric' src='/Public/images/Leoric.png' />
        </div>

        <div class='search-bar-inputs'>
            <input type='text' ng-model='battleTag'/>
            <input style="cursor: url('/Public/images/CursorDI.png'), auto;" type='button'
                   value='"I need a hero"- Bonnie Tyler' ng-click='getHeroInformation(battleTag)'
            />
        </div>

        <div class='hero-names'>
            <div ng-repeat='hero in heroList' ng-click='displayHeroInformation(hero)'>
                <div class='hero' ng-model='hero'>
                    {{hero.name}} - Lvl: {{hero.level}} , {{hero.class}}
                </div>
            </div>
        </div>
    </div>

    <div class='hero-equipment-container' ng-controller='Displayer' ng-show="show" ng-cloak>
        <div class='hero-stats'>
        <div class='hero-stats-header' ng-click='showStats()' ng-cloak>
            Character stats <br> {{character.name}} - Lvl: {{character.level}} , {{character.class}} <br>
            Paragon Level : {{character.paragonLevel}} <br>
        </div>
        <div class='border'>
        </div>
            <div class="stat-listing" ng-show='statListing' ng-cloak>
            <br>
                <div class = "red">
                Life:
                </div>
                <div class='chara-stat'>{{character.life}}</div> <br>
                <div class = "red">
                Damage:
                </div>
                <div class='chara-stat'> {{character.damage}}</div> <br>
                <div class = "red">
                Toughness:
                </div><div class='chara-stat'> {{character.toughness}}</div> <br>
               <div class = "red">
                Healing:
               </div><div class='chara-stat'> {{character.healing}}</div> <br>
                <div class = "red">
                Attack Speed:
                </div><div class='chara-stat'> {{character.attackSpeed}}</div> <br>
               <div class = "red">
                Armor:
               </div><div class='chara-stat'> {{character.armor}}</div> <br>
                <div class = "red">
                Strength:
                </div><div class='chara-stat'> {{character.strength}}</div> <br>
                <div class = "red">
                Dexterity:
                </div><div class='chara-stat'> {{character.dexterity}}</div> <br>
               <div class = "red">
                Vitality:
               </div><div class='chara-stat'> {{character.vitality}}</div> <br>
                <div class = "red">
                Intelligence:
                </div><div class='chara-stat'> {{character.intelligence}}</div> <br>
                <div class='border' ng-cloak>
                </div>
                <div class = "red">
                Physical Resist:
                </div>
                <div class='chara-stat'> {{character.physicalResist}}</div> <br>
                <div class = "red">
                Fire Resist:
                </div>
                <div class='chara-stat'> {{character.fireResist}}</div> <br>
                <div class = "red">
                Cold Resist:
                </div>
                <div class='chara-stat'>{{character.coldResist}}</div> <br>
               <div class = "red">
                Lightning Resist:
               </div>
               <div class='chara-stat'> {{character.lightningResist}}</div><br>
                <div class = "red">
                Poison Resist:
                </div>
                <div class='chara-stat'> {{character.poisonResist}}</div> <br>
               <div class = "red">
                Arcane Resist:
               </div>
               <div class='chara-stat'> {{character.arcaneResist}}</div><br>
                <div class='border' ng-cloak>
               </div>
               <div class = "red">
                Crit Damage:
               </div><div class='chara-stat'> {{character.critDamage}}</div><br>
               <div class = "red">
                Block Chance:
               </div><div class='chara-stat'> {{character.blockChance}}</div> <br>
                <div class = "red">
                Block Amount:
                </div><div class='chara-stat'> {{character.blockAmountMin}}</div> <br>
                <div class = "red">
                Block Amount Max:
                </div><div class='chara-stat'> {{character.blockAmountMax}}</div> <br>
                <div class = "red">
                Damage Increase:
                </div><div class='chara-stat'> {{character.damageIncrease}}</div> <br>
               <div class = "red">
                Critical Chance:
               </div><div class='chara-stat'>{{character.critChance}}</div> <br>
               <div class = "red">
                Damage Reduction:
               </div><div class='chara-stat'> {{character.damageReduction}}</div> <br>
                <div class = "red">
                Thorn Damage:
                </div><div class='chara-stat'> {{character.thorns}}</div> <br>
                <div class = "red">
                Life Steal :
                </div><div class='chara-stat'> {{character.lifeSteal}}</div> <br>
                <div class = "red">
                Life Per Kill:
                </div><div class='chara-stat'> {{character.lifePerKill}}</div> <br>
                <div class = "red">
                Gold Find:
                </div><div class='chara-stat'> {{character.goldFind}}</div> <br>
                <div class = "red">
                Magic Find:
                </div><div class='chara-stat'> {{character.magicFind}}</div> <br>
                <div class = "red">
                Life On Hit:
                </div><div class='chara-stat'> {{character.lifeOnHit}}</div> <br>
                <div class = "red">
                Primary Resource:
                </div><div class='chara-stat'> {{character.primaryResource}}</div> <br>
                <div class = "red">
                Secondary Resource:
                </div><div class='chara-stat'> {{character.secondaryResource}}</div> <br>
            </div>
        </div>
        <div class='hero-equipment '> 
            <div class='hero-equipment-header' ng-click='showEquipment()'>Hero's Equipment</div>
            <div class='border'></div>
            <div class='equipment-scroll' ng-show='equipment'>
                <table class= 'hero-equipment-table'>
                    <tr>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.shoulders.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.shoulders.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.head.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.head.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.neck.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.neck.icon}}.png"></a>
                        </td>
                    </tr>
                    <tr>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.hands.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.hands.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell' ><a href="http://us.battle.net/d3/en/{{character.torso.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.torso.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.bracers.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.bracers.icon}}.png"></a>
                        </td>
                    </tr>
                    <tr>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.rightFinger.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.rightFinger.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.waist.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.waist.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.leftFinger.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.leftFinger.icon}}.png"></a>
                        </td>
                    </tr>
                    <tr>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.mainHand.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.mainHand.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.legs.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.legs.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.offHand.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.offHand.icon}}.png"></a>
                        </td>
                    </tr>
                    <tr>
                        <td class='equipment-cell'></td>
                        <td class='equipment-cell'><a href="http://us.battle.net/d3/en/{{character.feet.tooltipParams}}"><img
                                src="http://media.blizzard.com/d3/icons/items/large/{{character.feet.icon}}.png"></a>
                        </td>
                        <td class='equipment-cell'></td>
                    </tr>
                </table>
            </div>

        </div>
    </div>

</div>


<!--  <script>
const function run(interval, frames) {
    var int = 1;
    function func(){
        document.body.class = 'b'+int
        int++
        if (int === frames) {int = 1;}
    }
    console.log(int)
    var swap = window.setInterval(func, interval);
}
run (1000,10);
<video xmlns="http://www.w3.org/1999/xhtml" id="malthael-video" class="video-bg is-active" loop="loop" poster="/public/images/malthael.jpg">
</script> -->

<!-- <audio controls className='audio' autoplay>
{"<source src='/Public/03-new-tristram.mp3' type='audio/mp3'>"}
</audio> -->

<script src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.js'></script>
<script>var app = angular.module('D3App', []);
app.controller('SearchBar', function ($scope, heroBackendService) {
    $scope.show = false;
    $scope.heroList;
    $scope.battleTag = 'slayeneq-1864';
    $scope.selectedId = '';
    $scope.getHeroInformation = function (tag) {
        heroBackendService.getProfile(tag).then(function (response) {
            $scope.heroList = response;
        })
    };
    $scope.displayHeroInformation = function (hero) {
        $scope.selectedId = hero.characterID;
        heroBackendService.getStats($scope.selectedId, $scope.battleTag).then(function (response) {
            $scope.character = {};
            $scope.character = response;
            $scope.character.name = hero.name;
            $scope.character.level = hero.level;
            $scope.character.class = hero.class;
            $scope.character.paragonLevel = hero.paragonLevel;
            $scope.show = true;
        })
                .then(function () {
                heroBackendService.getGear($scope.selectedId, 'feet')
               .then(function (response) {
               $scope.character.feet = {};
               $scope.character.feet = response;
                })
               .then(function () {
                heroBackendService.getGear($scope.selectedId, 'head')
                .then(function (response) {
                $scope.character.head = {};
                $scope.character.head = response;
                })
                .then(function () {
                heroBackendService.getGear($scope.selectedId, 'neck')
                .then(function (response) {
                 $scope.character.neck = {};
                 $scope.character.neck = response;
                 })
                 .then(function () {
                 heroBackendService.getGear($scope.selectedId, 'waist')
                 .then(function (response) {
                  $scope.character.waist = {};
                   $scope.character.waist = response;
                   })
                   .then(function () {
                   heroBackendService.getGear($scope.selectedId, 'shoulders')
                   .then(function (response) {
                   $scope.character.shoulders = {};
                     $scope.character.shoulders = response;
                   })
                   .then(function () {
                    heroBackendService.getGear($scope.selectedId, 'bracers')
                  .then(function (response) {
                 $scope.character.bracers = {};
                 $scope.character.bracers = response;
                })
               .then(function () {
               heroBackendService.getGear($scope.selectedId, 'hands')
               .then(function (response) {
                $scope.character.hands = {};
                 $scope.character.hands = response;
                  })
                 .then(function () {
                  heroBackendService.getGear($scope.selectedId, 'torso')
                 .then(function (response) {
                 $scope.character.torso = {};
                 $scope.character.torso = response;
                 })
                 .then(function () {
                 heroBackendService.getGear($scope.selectedId, 'rightFinger')
                 .then(function (response) {
                 $scope.character.rightFinger = {};
                 $scope.character.rightFinger = response;
                 })
                 .then(function () {
                 heroBackendService.getGear($scope.selectedId, 'mainHand')
                 .then(function (response) {
                 $scope.character.mainHand = {};
                 $scope.character.mainHand = response;
                 })
                 .then(function () {
                 heroBackendService.getGear($scope.selectedId, 'offHand')
                 .then(function (response) {
                 $scope.character.offHand = {};
                 $scope.character.offHand = response;
                 })
                 .then(function () {
                 heroBackendService.getGear($scope.selectedId, 'legs')
                 .then(function (response) {
                 $scope.character.legs = {};
                 $scope.character.legs = response;
                 })
                 .then(function () {
                 heroBackendService.getGear($scope.selectedId, 'leftFinger')
                 .then(function (response) {
                 $scope.character.leftFinger = {};
                 $scope.character.leftFinger = response;
                 console.log($scope.character)
                 })})})})})})})})})})})})})})}
});
app.controller('Displayer', function ($scope, $http, heroBackendService) {
    $scope.equipment = false;
    $scope.statListing = false;
    $scope.getCharacter = function () {
        return $scope.character;
    };
    $scope.showId = function () {
        return $scope.selectedId;
    };
    $scope.showbattleTag = function () {
        return $scope.battleTag;
    }
    $scope.showStats = function() {
      $scope.statListing = !$scope.statListing;  
    }
    $scope.showEquipment  = function() {
        $scope.equipment = !$scope.equipment;
    }
});
app.factory('heroBackendService', function ($http) {
    serviceObj = {};
    serviceObj.getProfile = function (tag) {
       return $http({method: 'Get', url: '/profile?id=' + tag})
                .then(function (response) {
                    return response.data;
                });
    };
    serviceObj.getStats = function (charId, battleTag) {
       return $http({
            method: 'Get',
            url: '/character?charId=' + charId + '&id=' + battleTag
        }).then(function (response) {
            return response.data[0];
        });
    };
    serviceObj.getGear = function (charId, slot) {
      return  $http({
            method: 'Get',
            url: '/character/item?charId=' + charId + '&slot=' + slot
        }).then(function (response) {
            return response.data;
        });
    };
    return serviceObj;
})
</script>

<!-- script will download and display the tooltip parameters on any link pointing to a diablo 3 item skill or skill calculator
//                                
//http://media.blizzard.com/d3/icons/items/large/unique_gloves_set_02_p2_demonhunter_male.png 
// icons are available for skills or items (items take large or small sizes, skills have pixel size allotments 21, 42 or 64);
//.png name is stored in items or skills database table under icon.
-->
<script src="http://us.battle.net/d3/static/js/tooltips.js"></script>
</body>

</html>